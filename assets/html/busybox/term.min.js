"use strict";function Term(t,s,e){this.w=t,this.h=s,this.cur_h=s,this.tot_h=1e3,this.y_base=0,this.y_disp=0,this.x=0,this.y=0,this.cursorstate=0,this.handler=e,this.convert_lf_to_crlf=!1,this.state=0,this.output_queue="",this.bg_colors=["#000000","#ff0000","#00ff00","#ffff00","#0000ff","#ff00ff","#00ffff","#ffffff"],this.fg_colors=["#000000","#ff0000","#00ff00","#ffff00","#0000ff","#ff00ff","#00ffff","#ffffff"],this.def_attr=56,this.cur_attr=this.def_attr,this.is_mac=navigator.userAgent.indexOf("Mac")>=0,this.key_rep_state=0,this.key_rep_str=""}Term.prototype.open=function(){var t,s,e,i,r;for(this.lines=new Array,r=32|this.def_attr<<16,t=0;t<this.cur_h;t++){for(s=new Array,e=0;e<this.w;e++)s[e]=r;this.lines[t]=s}for(document.writeln('<table border="0" cellspacing="0" cellpadding="0">'),t=0;t<this.h;t++)document.writeln('<tr><td class="term" id="tline'+t+'"></td></tr>');document.writeln("</table>"),this.refresh(0,this.h-1),document.addEventListener("keydown",this.keyDownHandler.bind(this),!0),document.addEventListener("keypress",this.keyPressHandler.bind(this),!0),i=this,setInterval(function(){i.cursor_timer_cb()},1e3)},Term.prototype.refresh=function(t,s){var e,i,r,h,a,c,o,_,n,f,u,y,p;for(i=t;i<=s;i++){for(p=i+this.y_disp,p>=this.cur_h&&(p-=this.cur_h),r=this.lines[p],h="",c=this.w,_=i==this.y&&this.cursor_state&&this.y_disp==this.y_base?this.x:-1,f=this.def_attr,o=0;o<c;o++){switch(a=r[o],n=a>>16,a&=65535,o==_&&(n=-1),n!=f&&(f!=this.def_attr&&(h+="</span>"),n!=this.def_attr&&(-1==n?h+='<span class="termReverse">':(h+='<span style="',u=n>>3&7,y=7&n,7!=u&&(h+="color:"+this.fg_colors[u]+";"),0!=y&&(h+="background-color:"+this.bg_colors[y]+";"),h+='">'))),a){case 32:h+="&nbsp;";break;case 38:h+="&amp;";break;case 60:h+="&lt;";break;case 62:h+="&gt;";break;default:h+=a<32?"&nbsp;":String.fromCharCode(a)}f=n}f!=this.def_attr&&(h+="</span>"),e=document.getElementById("tline"+i),e.innerHTML=h}},Term.prototype.cursor_timer_cb=function(){this.cursor_state^=1,this.refresh(this.y,this.y)},Term.prototype.show_cursor=function(){this.cursor_state||(this.cursor_state=1,this.refresh(this.y,this.y))},Term.prototype.scroll=function(){var t,s,e,i;for(this.cur_h<this.tot_h&&this.cur_h++,++this.y_base==this.cur_h&&(this.y_base=0),this.y_disp=this.y_base,e=32|this.def_attr<<16,t=new Array,s=0;s<this.w;s++)t[s]=e;i=this.y_base+this.h-1,i>=this.cur_h&&(i-=this.cur_h),this.lines[i]=t},Term.prototype.scroll_disp=function(t){var s,e;if(t>=0)for(s=0;s<t&&this.y_disp!=this.y_base;s++)++this.y_disp==this.cur_h&&(this.y_disp=0);else for(t=-t,e=this.y_base+this.h,e>=this.cur_h&&(e-=this.cur_h),s=0;s<t&&this.y_disp!=e;s++)--this.y_disp<0&&(this.y_disp=this.cur_h-1);this.refresh(0,this.h-1)},Term.prototype.write=function(t){function s(t){h=Math.min(h,t),a=Math.max(a,t)}function e(t,e,i){var r,h,a,c;for(c=t.y_base+i,c>=t.cur_h&&(c-=t.cur_h),r=t.lines[c],a=32|t.def_attr<<16,h=e;h<t.w;h++)r[h]=a;s(i)}var i,r,h,a,c,o,_;for(h=this.h,a=-1,s(this.y),this.y_base!=this.y_disp&&(this.y_disp=this.y_base,h=0,a=this.h-1),i=0;i<t.length;i++)switch(r=t.charCodeAt(i),this.state){case 0:switch(r){case 10:this.convert_lf_to_crlf&&(this.x=0),this.y++,this.y>=this.h&&(this.y--,this.scroll(),h=0,a=this.h-1);break;case 13:this.x=0;break;case 8:this.x>0&&this.x--;break;case 9:c=this.x+8&-8,c<=this.w&&(this.x=c);break;case 27:this.state=1;break;default:r>=32&&(this.x>=this.w&&(this.x=0,++this.y>=this.h&&(this.y--,this.scroll(),h=0,a=this.h-1)),_=this.y+this.y_base,_>=this.cur_h&&(_-=this.cur_h),this.lines[_][this.x]=65535&r|this.cur_attr<<16,this.x++,s(this.y))}break;case 1:91==r?(this.esc_params=new Array,this.cur_param=0,this.state=2):this.state=0;break;case 2:if(r>=48&&r<=57)this.cur_param=10*this.cur_param+r-48;else{if(this.esc_params[this.esc_params.length]=this.cur_param,this.cur_param=0,59==r)break;switch(this.state=0,r){case 65:c=this.esc_params[0],c<1&&(c=1),this.y-=c,this.y<0&&(this.y=0);break;case 66:c=this.esc_params[0],c<1&&(c=1),this.y+=c,this.y>=this.h&&(this.y=this.h-1);break;case 67:c=this.esc_params[0],c<1&&(c=1),this.x+=c,this.x>=this.w-1&&(this.x=this.w-1);break;case 68:c=this.esc_params[0],c<1&&(c=1),this.x-=c,this.x<0&&(this.x=0);break;case 72:var n,_;_=this.esc_params[0]-1,n=this.esc_params.length>=2?this.esc_params[1]-1:0,_<0?_=0:_>=this.h&&(_=this.h-1),n<0?n=0:n>=this.w&&(n=this.w-1),this.x=n,this.y=_;break;case 74:for(e(this,this.x,this.y),o=this.y+1;o<this.h;o++)e(this,0,o);break;case 75:e(this,this.x,this.y);break;case 109:!function(t,s){var e,i;if(0==s.length)t.cur_attr=t.def_attr;else for(e=0;e<s.length;e++)i=s[e],i>=30&&i<=37?t.cur_attr=-57&t.cur_attr|i-30<<3:i>=40&&i<=47?t.cur_attr=-8&t.cur_attr|i-40:0==i&&(t.cur_attr=t.def_attr)}(this,this.esc_params);break;case 110:this.queue_chars("["+(this.y+1)+";"+(this.x+1)+"R")}}}s(this.y),a>=h&&this.refresh(h,a)},Term.prototype.writeln=function(t){this.write(t+"\r\n")},Term.prototype.keyDownHandler=function(t){var s;switch(s="",t.keyCode){case 8:s="";break;case 9:s="\t";break;case 13:s="\r";break;case 27:s="";break;case 37:s="[D";break;case 39:s="[C";break;case 38:t.ctrlKey?this.scroll_disp(-1):s="[A";break;case 40:t.ctrlKey?this.scroll_disp(1):s="[B";break;case 46:s="[3~";break;case 45:s="[2~";break;case 36:s="OH";break;case 35:s="OF";break;case 33:t.ctrlKey?this.scroll_disp(-(this.h-1)):s="[5~";break;case 34:t.ctrlKey?this.scroll_disp(this.h-1):s="[6~";break;default:t.ctrlKey?t.keyCode>=65&&t.keyCode<=90?s=String.fromCharCode(t.keyCode-64):32==t.keyCode&&(s=String.fromCharCode(0)):(!this.is_mac&&t.altKey||this.is_mac&&t.metaKey)&&t.keyCode>=65&&t.keyCode<=90&&(s=""+String.fromCharCode(t.keyCode+32))}return s?(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.show_cursor(),this.key_rep_state=1,this.key_rep_str=s,this.handler(s),!1):(this.key_rep_state=0,!0)},Term.prototype.keyPressHandler=function(t){var s,e;if(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),s="","charCode"in t)e=t.charCode;else{if(e=t.keyCode,1==this.key_rep_state)return this.key_rep_state=2,!1;if(2==this.key_rep_state)return this.show_cursor(),this.handler(this.key_rep_str),!1}return 0!=e&&(t.ctrlKey||(this.is_mac||t.altKey)&&(!this.is_mac||t.metaKey)||(s=String.fromCharCode(e))),!s||(this.show_cursor(),this.handler(s),!1)},Term.prototype.queue_chars=function(t){this.output_queue+=t,this.output_queue&&setTimeout(this.outputHandler.bind(this),0)},Term.prototype.outputHandler=function(){this.output_queue&&(this.handler(this.output_queue),this.output_queue="")};
//# sourceMappingURL=term.min.js.map
